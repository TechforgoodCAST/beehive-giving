:javascript
  mixpanel.track("Page View", {"Page Name": "Recipient Funders Index"});

#bg-color{style: 'min-height: 550px'}
  .uk-container.uk-container-center
    .uk-grid.uk-margin
      .uk-width-1-1.uk-margin
        %h1.uk-margin-top.uk-hidden Funders
        -# %a.uk-text-small{"data-uk-modal" => "{target:'#about-dashboard'}"} What's this?

        .uk-grid.uk-margin-top
          .uk-width-medium-1-1.uk-width-large-1-3
            - unless @recipient.profiles.count > 0 && @recipient.unlocked_funders.any? && @recipient.eligibilities.count > 0
              .uk-panel.uk-panel-box#panel.uk-margin-top-remove.uk-margin-bottom
                .uk-panel-title Get started
                %ol.uk-nav.uk-nav-side
                  - unless @recipient.profiles.count > 0
                    %li
                      %a{href: new_recipient_profile_path(@recipient, :redirect_to_funder => Funder.first)}
                        1. Add details to help match your organisation
                  - else
                    %li
                      %a.uk-text-muted
                        %strike 1. Add details to help match your organisation

                  - unless @recipient.unlocked_funders.any?
                    %li
                      %a{href: recipient_comparison_path(Funder.first)}
                        2. See how you compare with The Foundation
                  - else
                    %li
                      %a.uk-text-muted
                        %strike 2. See how you compare with The Foundation

                  - unless @recipient.eligibilities.count > 0 # refactor
                    %li
                      %a{href: recipient_eligibility_path(Funder.first)}
                        3. See if you're eligible for The Foundation
                  - else
                    %li
                      %a.uk-text-muted
                        %strike 3. See if you're eligible for The Foundation

            = search_form_for @search, url: funders_path do |f|
              .uk-width-1-1.uk-margin-bottom{"data-uk-sticky" => "{top:60, media: 959}"}
                .uk-panel.uk-panel-box#panel.uk-margin-top-remove
                  .uk-panel-title
                    Find funders
                    %a.uk-text-small{:'data-uk-toggle' => "{target: '.js-dashboard-search-form'}"} More options
                    -# .uk-text-small
                    -#   Sort:
                    -#   = sort_link @search, :name, 'Funder name', default_order: :asc
                    -#   |
                    -#   = sort_link @search, :funder_grants_grant_type, 'Funding type', default_order: :asc
                  .uk-grid.uk-margin-top-remove
                    .uk-width-1-1
                      .uk-form.uk-form-stacked
                        .uk-width-1-1
                          %label.uk-form-label
                            = f.label "Funder name"
                          .uk-form-controls
                            = f.input :name_cont, input_html: { class: 'uk-width-1-1' }
                        -# .uk-width-1-1.uk-margin-top.uk-margin-bottom
                        -#   %label.uk-form-label
                        -#     = f.label "Active"
                        -#   .uk-form-controls
                        -#     = f.input :active_on_beehive_eq, as: :select, input_html: { class: 'uk-width-1-1' }
                        = render :partial => 'recipients/filter_slim', locals: {f: f}

                .uk-grid
                  .uk-width-2-3
                    = f.submit 'Filter funders', class: "uk-width-1-1 uk-button uk-button-primary", style: 'color: #fff;'
                  .uk-width-1-3{style: 'padding-left: 0;'}
                    = link_to "Clear", request.path, class: "uk-width-1-1 uk-button"

                .uk-panel.uk-panel-box.uk-overlay-panel#panel.uk-margin-top
                  %h3 Recommended funders
                  .uk-panel.uk-text-center.uk-vertical-align{style: 'border: 3px #ddd dashed; height: 80px;'}
                    .uk-vertical-align-middle
                      %h3.uk-margin-top.uk-text-muted Coming soon...
                .uk-width-1-1.uk-button.uk-margin-bottom#mp-find-out-more{"data-uk-modal" => "{target:'#about-recommendation'}"} Find out more

          .uk-width-medium-1-1.uk-width-large-2-3.uk-margin-bottom
            - if @recipient.profiles.count < 1
              .uk-alert.uk-alert-warning{'data-uk-alert' => ''}
                %o In order to unlock funders you need to complete your profile. We'll use the information you provide to construct a unique digital fingerprint for your organisation, enabling us to give you personalised funding recommendations.
                = link_to 'Click here', new_recipient_profile_path(@recipient)
                to create a profile.
            .uk-grid.uk-margin-top-remove.uk-animation-fade{"data-uk-grid-match" => ""}
              - @funders.to_a.uniq.each do |funder|
                .uk-width-medium-1-2.uk-margin-bottom
                  .uk-width-1-1.uk-panel#panel.uk-overlay

                    - if @recipient.eligible?(funder)
                      .uk-panel-badge.uk-badge.uk-badge-success{style: 'margin: 6px;'} Eligible
                    - elsif !@recipient.eligible?(funder) && @recipient.eligibility_count(funder) > 0
                      .uk-panel-badge.uk-badge.uk-badge-danger{style: 'margin: 8px 6px;'} Not eligible

                    .uk-panel-teaser.uk-text-center.uk-vertical-align{style: 'height: 100px;'}
                      .uk-vertical-align-middle
                        = image_tag "logos/#{funder.slug}-logo.png", alt: "#{funder.name}"
                    -# - if params[:q]
                    -#   .uk-panel-box.uk-text-center
                    -#     = percentage_of_grants(funder)
                    -#     of funding meets your search criteria
                    .uk-overlay-area
                      .uk-overlay-area-content
                        - if funder.active_on_beehive? && funder.attributes.count > 0
                          %a.uk-button.uk-button-primary.uk-button-large.uk-width-1-1{ href: recipient_comparison_path(funder) }
                            See how you compare
                            - if @recipient.locked_funder?(funder)
                              %span.uk-text-small (Locked)
                              %i.uk-icon-lock
                        - else
                          - if @recipient.can_request_funder?(funder, 'data_requested')
                            = link_to 'Request', vote_recipient_path(@recipient.id,  data_requested: true, funder_id: funder.id, recipient_id: @recipient.id), method: 'post', class: 'uk-button uk-button-large uk-width-1-1'
                          - else
                            %button.uk-button.uk-button-primary.uk-button-large.uk-width-1-1{:disabled => "", :type => "button"}
                              %i.uk-icon-check Requested

                    = render :partial => 'recipients/funder_attributes', :locals => { :funder => funder }

              .uk-width-medium-1-2.uk-margin-bottom
                .uk-width-1-1.uk-panel
                  .uk-text-center.uk-vertical-align{style: 'border: 3px #ddd dashed; height: 100px;'}
                    .uk-vertical-align-middle
                      %h3.uk-margin-top.uk-text-muted More coming soon...

#about-recommendation.uk-modal
  .uk-modal-dialog
    %a.uk-modal-close.uk-close
    .uk-modal-header
      %h2 Recommended funders
    %o From here you can start to discover and compare which funders are best for your organisation. Right now it's a little basic, but we'll be adding more funders, and features in the coming months. Importantly, by signing up you've provided us with vital information to help us develop advanced recommendation features, so watch this space...
